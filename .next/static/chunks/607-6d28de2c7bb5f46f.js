"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[607],{9743:function(e,t,r){r.r(t),r.d(t,{Headers:function(){return s},Request:function(){return o},Response:function(){return a},fetch:function(){return n}});var i=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==r.g)return r.g;throw Error("unable to locate global object")}();let n=i.fetch;t.default=i.fetch.bind(i);let s=i.Headers,o=i.Request,a=i.Response},7525:function(e,t,r){r.d(t,{eI:function(){return tS}});let i=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,9743)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)};class n extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class s extends n{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class o extends n{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class a extends n{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}class l{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=i(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r,i,n,l,c;return i=this,n=void 0,l=void 0,c=function*(){try{let i;let{headers:n,method:l,body:c}=t,h={};c&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&("undefined"!=typeof Blob&&c instanceof Blob||c instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",i=c):"string"==typeof c?(h["Content-Type"]="text/plain",i=c):"undefined"!=typeof FormData&&c instanceof FormData?i=c:(h["Content-Type"]="application/json",i=JSON.stringify(c)));let u=yield this.fetch(`${this.url}/${e}`,{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),n),body:i}).catch(e=>{throw new s(e)}),d=u.headers.get("x-relay-error");if(d&&"true"===d)throw new o(u);if(!u.ok)throw new a(u);let f=(null!==(r=u.headers.get("Content-Type"))&&void 0!==r?r:"text/plain").split(";")[0].trim();return{data:"application/json"===f?yield u.json():"application/octet-stream"===f?yield u.blob():"multipart/form-data"===f?yield u.formData():yield u.text(),error:null}}catch(e){return{data:null,error:e}}},new(l||(l=Promise))(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function s(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){var i;t.done?e(t.value):((i=t.value)instanceof l?i:new l(function(e){e(i)})).then(r,s)}o((c=c.apply(i,n||[])).next())})}}var c,h,u,d,f,p,g,m,y,v,w,b,_,k,T,x,S,E,O,P=r(9743);class j extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}}class C{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=P.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let r=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,r,i;let n=null,s=null,o=null,a=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){let t=await e.text();""===t||(s="text/csv"===this.headers.Accept?t:this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}let i=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(r=e.headers.get("content-range"))||void 0===r?void 0:r.split("/");i&&c&&c.length>1&&(o=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(s)&&(s.length>1?(n={code:"PGRST116",details:`Results contain ${s.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},s=null,o=null,a=406,l="Not Acceptable"):s=1===s.length?s[0]:null)}else{let t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(s=[],n=null,a=200,l="OK")}catch(r){404===e.status&&""===t?(a=204,l="No Content"):n={message:t}}if(n&&this.isMaybeSingle&&(null===(i=null==n?void 0:n.details)||void 0===i?void 0:i.includes("0 rows"))&&(n=null,a=200,l="OK"),n&&this.shouldThrowOnError)throw new j(n)}return{error:n,data:s,count:o,status:a,statusText:l}});return this.shouldThrowOnError||(r=r.catch(e=>{var t,r,i;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(r=null==e?void 0:e.stack)&&void 0!==r?r:""}`,hint:"",code:`${null!==(i=null==e?void 0:e.code)&&void 0!==i?i:""}`},data:null,count:null,status:0,statusText:""}})),r.then(e,t)}}class $ extends C{select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:i,referencedTable:n=i}={}){let s=n?`${n}.order`:"order",o=this.url.searchParams.get(s);return this.url.searchParams.set(s,`${o?`${o},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(i,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:i=r}={}){let n=void 0===i?"offset":`${i}.offset`,s=void 0===i?"limit":`${i}.limit`;return this.url.searchParams.set(n,`${e}`),this.url.searchParams.set(s,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:i=!1,wal:n=!1,format:s="text"}={}){var o;let a=[e?"analyze":null,t?"verbose":null,r?"settings":null,i?"buffers":null,n?"wal":null].filter(Boolean).join("|"),l=null!==(o=this.headers.Accept)&&void 0!==o?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${s}; for="${l}"; options=${a};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class R extends ${eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){let r=t.map(e=>"string"==typeof e&&RegExp("[,()]").test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:i}={}){let n="";"plain"===i?n="pl":"phrase"===i?n="ph":"websearch"===i&&(n="w");let s=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${n}fts${s}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let i=r?`${r}.or`:"or";return this.url.searchParams.append(i,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class A{constructor(e,{headers:t={},schema:r,fetch:i}){this.url=e,this.headers=t,this.schema=r,this.fetch=i}select(e,{head:t=!1,count:r}={}){let i=!1,n=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!i?"":('"'===e&&(i=!i),e)).join("");return this.url.searchParams.set("select",n),r&&(this.headers.Prefer=`count=${r}`),new R({method:t?"HEAD":"GET",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){let i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new R({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:i,defaultToNull:n=!0}={}){let s=[`resolution=${r?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&s.push(this.headers.Prefer),i&&s.push(`count=${i}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);this.url.searchParams.set("columns",e.join(","))}}return new R({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){let r=[];return this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),this.headers.Prefer=r.join(","),new R({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){let t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new R({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}let L={"X-Client-Info":"postgrest-js/1.9.2"};class I{constructor(e,{headers:t={},schema:r,fetch:i}={}){this.url=e,this.headers=Object.assign(Object.assign({},L),t),this.schemaName=r,this.fetch=i}from(e){return new A(new URL(`${this.url}/${e}`),{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new I(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,t={},{head:r=!1,count:i}={}){let n,s;let o=new URL(`${this.url}/rpc/${e}`);r?(n="HEAD",Object.entries(t).forEach(([e,t])=>{o.searchParams.append(e,`${t}`)})):(n="POST",s=t);let a=Object.assign({},this.headers);return i&&(a.Prefer=`count=${i}`),new R({method:n,url:o,headers:a,schema:this.schemaName,body:s,fetch:this.fetch,allowEmpty:!1})}}let D={"X-Client-Info":"realtime-js/2.9.3"};(w=c||(c={}))[w.connecting=0]="connecting",w[w.open=1]="open",w[w.closing=2]="closing",w[w.closed=3]="closed",(b=h||(h={})).closed="closed",b.errored="errored",b.joined="joined",b.joining="joining",b.leaving="leaving",(_=u||(u={})).close="phx_close",_.error="phx_error",_.join="phx_join",_.reply="phx_reply",_.leave="phx_leave",_.access_token="access_token",(d||(d={})).websocket="websocket",(k=f||(f={})).Connecting="connecting",k.Open="open",k.Closing="closing",k.Closed="closed";class N{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class U{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):"string"==typeof e?t(JSON.parse(e)):t({})}_binaryDecode(e){let t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){let i=t.getUint8(1),n=t.getUint8(2),s=this.HEADER_LENGTH+2,o=r.decode(e.slice(s,s+i));s+=i;let a=r.decode(e.slice(s,s+n));return s+=n,{ref:null,topic:o,event:a,payload:JSON.parse(r.decode(e.slice(s,e.byteLength)))}}}class F{constructor(e,t,r={},i=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=i,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null===(r=this.receivedResp)||void 0===r?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}(T=p||(p={})).SYNC="sync",T.JOIN="join",T.LEAVE="leave";class M{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.joinRef=this.channel._joinRef(),this.state=M.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=M.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],i()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:i}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=M.syncDiff(this.state,e,t,r),i())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,i){let n=this.cloneDeep(e),s=this.transformState(t),o={},a={};return this.map(n,(e,t)=>{s[e]||(a[e]=t)}),this.map(s,(e,t)=>{let r=n[e];if(r){let i=t.map(e=>e.presence_ref),n=r.map(e=>e.presence_ref),s=t.filter(e=>0>n.indexOf(e.presence_ref)),l=r.filter(e=>0>i.indexOf(e.presence_ref));s.length>0&&(o[e]=s),l.length>0&&(a[e]=l)}else o[e]=t}),this.syncDiff(n,{joins:o,leaves:a},r,i)}static syncDiff(e,t,r,i){let{joins:n,leaves:s}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),i||(i=()=>{}),this.map(n,(t,i)=>{var n;let s=null!==(n=e[t])&&void 0!==n?n:[];if(e[t]=this.cloneDeep(i),s.length>0){let r=e[t].map(e=>e.presence_ref),i=s.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...i)}r(t,s,i)}),this.map(s,(t,r)=>{let n=e[t];if(!n)return;let s=r.map(e=>e.presence_ref);n=n.filter(e=>0>s.indexOf(e.presence_ref)),e[t]=n,i(t,n,r),0===n.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let i=e[r];return"metas"in i?t[r]=i.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=i,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(x=g||(g={})).abstime="abstime",x.bool="bool",x.date="date",x.daterange="daterange",x.float4="float4",x.float8="float8",x.int2="int2",x.int4="int4",x.int4range="int4range",x.int8="int8",x.int8range="int8range",x.json="json",x.jsonb="jsonb",x.money="money",x.numeric="numeric",x.oid="oid",x.reltime="reltime",x.text="text",x.time="time",x.timestamp="timestamp",x.timestamptz="timestamptz",x.timetz="timetz",x.tsrange="tsrange",x.tstzrange="tstzrange";let z=(e,t,r={})=>{var i;let n=null!==(i=r.skipTypes)&&void 0!==i?i:[];return Object.keys(t).reduce((r,i)=>(r[i]=B(i,e,t,n),r),{})},B=(e,t,r,i)=>{let n=t.find(t=>t.name===e),s=null==n?void 0:n.type,o=r[e];return s&&!i.includes(s)?q(s,o):H(o)},q=(e,t)=>{if("_"===e.charAt(0))return G(t,e.slice(1,e.length));switch(e){case g.bool:return J(t);case g.float4:case g.float8:case g.int2:case g.int4:case g.int8:case g.numeric:case g.oid:return K(t);case g.json:case g.jsonb:return W(t);case g.timestamp:return V(t);case g.abstime:case g.date:case g.daterange:case g.int4range:case g.int8range:case g.money:case g.reltime:case g.text:case g.time:case g.timestamptz:case g.timetz:case g.tsrange:case g.tstzrange:default:return H(t)}},H=e=>e,J=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},K=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},W=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){console.log(`JSON parse error: ${e}`)}return e},G=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,i=e[r];if("{"===e[0]&&"}"===i){let i;let n=e.slice(1,r);try{i=JSON.parse("["+n+"]")}catch(e){i=n?n.split(","):[]}return i.map(e=>q(t,e))}return e},V=e=>"string"==typeof e?e.replace(" ","T"):e;(S=m||(m={})).ALL="*",S.INSERT="INSERT",S.UPDATE="UPDATE",S.DELETE="DELETE",(E=y||(y={})).BROADCAST="broadcast",E.PRESENCE="presence",E.POSTGRES_CHANGES="postgres_changes",(O=v||(v={})).SUBSCRIBED="SUBSCRIBED",O.TIMED_OUT="TIMED_OUT",O.CLOSED="CLOSED",O.CHANNEL_ERROR="CHANNEL_ERROR";class Y{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=h.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new F(this,u.join,this.params,this.timeout),this.rejoinTimer=new N(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=h.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=h.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=h.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=h.errored,this.rejoinTimer.scheduleTimeout())}),this._on(u.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new M(this),this.broadcastEndpointURL=this._broadcastEndpointURL()}subscribe(e,t=this.timeout){var r,i;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{let{config:{broadcast:n,presence:s}}=this.params;this._onError(t=>e&&e("CHANNEL_ERROR",t)),this._onClose(()=>e&&e("CLOSED"));let o={},a={broadcast:n,presence:s,postgres_changes:null!==(i=null===(r=this.bindings.postgres_changes)||void 0===r?void 0:r.map(e=>e.filter))&&void 0!==i?i:[]};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:a},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:t})=>{var r;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),void 0===t){e&&e("SUBSCRIBED");return}{let i=this.bindings.postgres_changes,n=null!==(r=null==i?void 0:i.length)&&void 0!==r?r:0,s=[];for(let r=0;r<n;r++){let n=i[r],{filter:{event:o,schema:a,table:l,filter:c}}=n,h=t&&t[r];if(h&&h.event===o&&h.schema===a&&h.table===l&&h.filter===c)s.push(Object.assign(Object.assign({},n),{id:h.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=s,e&&e("SUBSCRIBED");return}}).receive("error",t=>{e&&e("CHANNEL_ERROR",Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this._on(e,t,r)}async send(e,t={}){var r,i;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var i,n,s;let o=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(s=null===(n=null===(i=this.params)||void 0===i?void 0:i.config)||void 0===n?void 0:n.broadcast)||void 0===s?void 0:s.ack)||r("ok"),o.receive("ok",()=>r("ok")),o.receive("timeout",()=>r("timed out"))});{let{event:n,payload:s}=e,o={method:"POST",headers:{apikey:null!==(r=this.socket.apiKey)&&void 0!==r?r:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:n,payload:s}]})};try{if((await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(i=t.timeout)&&void 0!==i?i:this.timeout)).ok)return"ok";return"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=h.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(u.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{let i=new F(this,u.leave,{},e);i.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),i.send(),this._canPush()||i.trigger("ok",{})})}_broadcastEndpointURL(){let e=this.socket.endPoint;return(e=(e=e.replace(/^ws/i,"http")).replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,"")).replace(/\/+$/,"")+"/api/broadcast"}async _fetchWithTimeout(e,t,r){let i=new AbortController,n=setTimeout(()=>i.abort(),r),s=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:i.signal}));return clearTimeout(n),s}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let i=new F(this,e,t,r);return this._canPush()?i.send():(i.startTimeout(),this.pushBuffer.push(i)),i}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var i,n;let s=e.toLocaleLowerCase(),{close:o,error:a,leave:l,join:c}=u;if(r&&[o,a,l,c].indexOf(s)>=0&&r!==this._joinRef())return;let h=this._onMessage(s,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(s)?null===(i=this.bindings.postgres_changes)||void 0===i||i.filter(e=>{var t,r,i;return(null===(t=e.filter)||void 0===t?void 0:t.event)==="*"||(null===(i=null===(r=e.filter)||void 0===r?void 0:r.event)||void 0===i?void 0:i.toLocaleLowerCase())===s}).map(e=>e.callback(h,r)):null===(n=this.bindings[s])||void 0===n||n.filter(e=>{var r,i,n,o,a,l;if(!["broadcast","presence","postgres_changes"].includes(s))return e.type.toLocaleLowerCase()===s;if("id"in e){let s=e.id,o=null===(r=e.filter)||void 0===r?void 0:r.event;return s&&(null===(i=t.ids)||void 0===i?void 0:i.includes(s))&&("*"===o||(null==o?void 0:o.toLocaleLowerCase())===(null===(n=t.data)||void 0===n?void 0:n.type.toLocaleLowerCase()))}{let r=null===(a=null===(o=null==e?void 0:e.filter)||void 0===o?void 0:o.event)||void 0===a?void 0:a.toLocaleLowerCase();return"*"===r||r===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof h&&"ids"in h){let e=h.data,{schema:t,table:r,commit_timestamp:i,type:n,errors:s}=e;h=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:i,eventType:n,new:{},old:{},errors:s}),this._getPayloadRecords(e))}e.callback(h,r)})}_isClosed(){return this.state===h.closed}_isJoined(){return this.state===h.joined}_isJoining(){return this.state===h.joining}_isLeaving(){return this.state===h.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let i=e.toLocaleLowerCase(),n={type:i,filter:t,callback:r};return this.bindings[i]?this.bindings[i].push(n):this.bindings[i]=[n],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(e=>{var i;return!((null===(i=e.type)||void 0===i?void 0:i.toLocaleLowerCase())===r&&Y.isEqual(e.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(u.close,{},e)}_onError(e){this._on(u.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=h.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=z(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=z(e.columns,e.old_record)),t}}let Z=()=>{},X="undefined"!=typeof WebSocket;class Q{constructor(e,t){var i;this.accessToken=null,this.apiKey=null,this.channels=[],this.endPoint="",this.headers=D,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Z,this.conn=null,this.sendBuffer=[],this.serializer=new U,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,9743)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${d.websocket}`,(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);let n=null===(i=null==t?void 0:t.params)||void 0===i?void 0:i.apikey;n&&(this.accessToken=n,this.apiKey=n),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new N(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this._endPointURL(),void 0,{headers:this.headers});return}if(X){this.conn=new WebSocket(this._endPointURL()),this.setupConnection();return}this.conn=new ee(this._endPointURL(),void 0,{close:()=>{this.conn=null}}),r.e(276).then(r.t.bind(r,2276,23)).then(({default:e})=>{this.conn=new e(this._endPointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case c.connecting:return f.Connecting;case c.open:return f.Open;case c.closing:return f.Closing;default:return f.Closed}}isConnected(){return this.connectionState()===f.Open}channel(e,t={config:{}}){let r=new Y(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){let{topic:t,event:r,payload:i,ref:n}=e,s=()=>{this.encode(e,e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)})};this.log("push",`${t} ${r} (${n})`,i),this.isConnected()?s():this.sendBuffer.push(s)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(u.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}_onConnMessage(e){this.decode(e.data,e=>{let{topic:t,event:r,payload:i,ref:n}=e;(n&&n===this.pendingHeartbeatRef||r===(null==i?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${t} ${r} ${n&&"("+n+")"||""}`,i),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,i,n)),this.stateChangeCallbacks.message.forEach(t=>t(e))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(u.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",i=new URLSearchParams(t);return`${e}${r}${i}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ee{constructor(e,t,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=c.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class et extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function er(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class ei extends et{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class en extends et{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}let es=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,9743)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},eo=()=>{var e,t,i,n;return e=void 0,t=void 0,i=void 0,n=function*(){return"undefined"==typeof Response?(yield Promise.resolve().then(r.bind(r,9743))).Response:Response},new(i||(i=Promise))(function(r,s){function o(e){try{l(n.next(e))}catch(e){s(e)}}function a(e){try{l(n.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?r(e.value):((t=e.value)instanceof i?t:new i(function(e){e(t)})).then(o,a)}l((n=n.apply(e,t||[])).next())})};var ea=function(e,t,r,i){return new(r||(r=Promise))(function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})};let el=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),ec=(e,t)=>ea(void 0,void 0,void 0,function*(){e instanceof(yield eo())?e.json().then(r=>{t(new ei(el(r),e.status||500))}).catch(e=>{t(new en(el(e),e))}):t(new en(el(e),e))}),eh=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),r))};function eu(e,t,r,i,n,s){return ea(this,void 0,void 0,function*(){return new Promise((o,a)=>{e(r,eh(t,i,n,s)).then(e=>{if(!e.ok)throw e;return(null==i?void 0:i.noResolveJson)?e:e.json()}).then(e=>o(e)).catch(e=>ec(e,a))})})}function ed(e,t,r,i){return ea(this,void 0,void 0,function*(){return eu(e,"GET",t,r,i)})}function ef(e,t,r,i,n){return ea(this,void 0,void 0,function*(){return eu(e,"POST",t,i,n,r)})}function ep(e,t,r,i,n){return ea(this,void 0,void 0,function*(){return eu(e,"DELETE",t,i,n,r)})}var eg=function(e,t,r,i){return new(r||(r=Promise))(function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})};let em={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ey={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ev{constructor(e,t={},r,i){this.url=e,this.headers=t,this.bucketId=r,this.fetch=es(i)}uploadOrUpdate(e,t,r,i){return eg(this,void 0,void 0,function*(){try{let n;let s=Object.assign(Object.assign({},ey),i),o=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(s.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((n=new FormData).append("cacheControl",s.cacheControl),n.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(n=r).append("cacheControl",s.cacheControl):(n=r,o["cache-control"]=`max-age=${s.cacheControl}`,o["content-type"]=s.contentType);let a=this._removeEmptyFolders(t),l=this._getFinalPath(a),c=yield this.fetch(`${this.url}/object/${l}`,Object.assign({method:e,body:n,headers:o},(null==s?void 0:s.duplex)?{duplex:s.duplex}:{})),h=yield c.json();if(c.ok)return{data:{path:a,id:h.Id,fullPath:h.Key},error:null};return{data:null,error:h}}catch(e){if(er(e))return{data:null,error:e};throw e}})}upload(e,t,r){return eg(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,i){return eg(this,void 0,void 0,function*(){let n=this._removeEmptyFolders(e),s=this._getFinalPath(n),o=new URL(this.url+`/object/upload/sign/${s}`);o.searchParams.set("token",t);try{let e;let t=Object.assign({upsert:ey.upsert},i),s=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,s["cache-control"]=`max-age=${t.cacheControl}`,s["content-type"]=t.contentType);let a=yield this.fetch(o.toString(),{method:"PUT",body:e,headers:s}),l=yield a.json();if(a.ok)return{data:{path:n,fullPath:l.Key},error:null};return{data:null,error:l}}catch(e){if(er(e))return{data:null,error:e};throw e}})}createSignedUploadUrl(e){return eg(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e),r=yield ef(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),i=new URL(this.url+r.url),n=i.searchParams.get("token");if(!n)throw new et("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:n},error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}update(e,t,r){return eg(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return eg(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}copy(e,t){return eg(this,void 0,void 0,function*(){try{return{data:{path:(yield ef(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}createSignedUrl(e,t,r){return eg(this,void 0,void 0,function*(){try{let i=this._getFinalPath(e),n=yield ef(this.fetch,`${this.url}/object/sign/${i}`,Object.assign({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:this.headers}),s=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:n={signedUrl:encodeURI(`${this.url}${n.signedURL}${s}`)},error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}createSignedUrls(e,t,r){return eg(this,void 0,void 0,function*(){try{let i=yield ef(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{data:i.map(e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${n}`):null})),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}download(e,t){return eg(this,void 0,void 0,function*(){let r=void 0!==(null==t?void 0:t.transform),i=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),n=i?`?${i}`:"";try{let t=this._getFinalPath(e),i=yield ed(this.fetch,`${this.url}/${r?"render/image/authenticated":"object"}/${t}${n}`,{headers:this.headers,noResolveJson:!0});return{data:yield i.blob(),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}getPublicUrl(e,t){let r=this._getFinalPath(e),i=[],n=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==n&&i.push(n);let s=void 0!==(null==t?void 0:t.transform),o=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==o&&i.push(o);let a=i.join("&");return""!==a&&(a=`?${a}`),{data:{publicUrl:encodeURI(`${this.url}/${s?"render/image":"object"}/public/${r}${a}`)}}}remove(e){return eg(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}list(e,t,r){return eg(this,void 0,void 0,function*(){try{let i=Object.assign(Object.assign(Object.assign({},em),t),{prefix:e||""});return{data:yield ef(this.fetch,`${this.url}/object/list/${this.bucketId}`,i,{headers:this.headers},r),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}let ew={"X-Client-Info":"storage-js/2.5.5"};var eb=function(e,t,r,i){return new(r||(r=Promise))(function(n,s){function o(e){try{l(i.next(e))}catch(e){s(e)}}function a(e){try{l(i.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?n(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}l((i=i.apply(e,t||[])).next())})};class e_{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},ew),t),this.fetch=es(r)}listBuckets(){return eb(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}getBucket(e){return eb(this,void 0,void 0,function*(){try{return{data:yield ed(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}createBucket(e,t={public:!1}){return eb(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}updateBucket(e,t){return eb(this,void 0,void 0,function*(){try{return{data:yield function(e,t,r,i,n){return ea(this,void 0,void 0,function*(){return eu(e,"PUT",t,i,void 0,r)})}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}emptyBucket(e){return eb(this,void 0,void 0,function*(){try{return{data:yield ef(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}deleteBucket(e){return eb(this,void 0,void 0,function*(){try{return{data:yield ep(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(e){if(er(e))return{data:null,error:e};throw e}})}}class ek extends e_{constructor(e,t={},r){super(e,t,r)}from(e){return new ev(this.url,this.headers,e,this.fetch)}}let eT="";eT="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ex={"X-Client-Info":`supabase-js-${eT}/2.39.3`},eS=e=>{let t;return t=e||("undefined"==typeof fetch?P.default:fetch),(...e)=>t(...e)},eE=()=>"undefined"==typeof Headers?P.Headers:Headers,eO=(e,t,r)=>{let i=eS(r),n=eE();return(r,s)=>{var o,a,l,c;return o=void 0,a=void 0,l=void 0,c=function*(){var o;let a=null!==(o=yield t())&&void 0!==o?o:e,l=new n(null==s?void 0:s.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${a}`),i(r,Object.assign(Object.assign({},s),{headers:l}))},new(l||(l=Promise))(function(e,t){function r(e){try{n(c.next(e))}catch(e){t(e)}}function i(e){try{n(c.throw(e))}catch(e){t(e)}}function n(t){var n;t.done?e(t.value):((n=t.value)instanceof l?n:new l(function(e){e(n)})).then(r,i)}n((c=c.apply(o,a||[])).next())})}},eP=()=>"undefined"!=typeof document,ej={tested:!1,writable:!1},eC=()=>{if(!eP())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(ej.tested)return ej.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),ej.tested=!0,ej.writable=!0}catch(e){ej.tested=!0,ej.writable=!1}return ej.writable};function e$(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}let eR=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>Promise.resolve().then(r.bind(r,9743)).then(({default:t})=>t(...e)):fetch),(...e)=>t(...e)},eA=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,eL=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},eI=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},eD=async(e,t)=>{await e.removeItem(t)};class eN{constructor(){this.promise=new eN.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function eU(e){let t=e.split(".");if(3!==t.length)throw Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw Error("JWT is not valid: payload is not in base64url format");return JSON.parse(function(e){let t,r,i,n,s,o,a;let l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",h=0;for(e=e.replace("-","+").replace("_","/");h<e.length;)n=l.indexOf(e.charAt(h++)),s=l.indexOf(e.charAt(h++)),o=l.indexOf(e.charAt(h++)),a=l.indexOf(e.charAt(h++)),t=n<<2|s>>4,r=(15&s)<<4|o>>2,i=(3&o)<<6|a,c+=String.fromCharCode(t),64!=o&&0!=r&&(c+=String.fromCharCode(r)),64!=a&&0!=i&&(c+=String.fromCharCode(i));return c}(t[1]))}async function eF(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function eM(e){return("0"+e.toString(16)).substr(-2)}function ez(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let i=0;i<56;i++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,eM).join("")}async function eB(e){let t=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(e=>String.fromCharCode(e)).join("")}async function eq(e){return"undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder?btoa(await eB(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e)}eN.promiseConstructor=Promise;class eH extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function eJ(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class eK extends eH{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class eW extends eH{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class eG extends eH{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class eV extends eG{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class eY extends eG{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class eZ extends eG{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class eX extends eG{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class eQ extends eG{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class e0 extends eG{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function e1(e){return eJ(e)&&"AuthRetryableFetchError"===e.name}class e2 extends eG{constructor(e,t,r){super(e,"AuthWeakPasswordError",t),this.reasons=r}}var e3=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};let e4=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),e5=[502,503,504];async function e6(e){let t;if(!eA(e))throw new e0(e4(e),0);if(e5.includes(e.status))throw new e0(e4(e),e.status);try{t=await e.json()}catch(e){throw new eW(e4(e),e)}if("object"==typeof t&&t&&"object"==typeof t.weak_password&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new e2(e4(t),e.status,t.weak_password.reasons);throw new eK(e4(t),e.status||500)}let e9=(e,t,r,i)=>{let n={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),n.body=JSON.stringify(i),Object.assign(Object.assign({},n),r))};async function e7(e,t,r,i){var n;let s=Object.assign({},null==i?void 0:i.headers);(null==i?void 0:i.jwt)&&(s.Authorization=`Bearer ${i.jwt}`);let o=null!==(n=null==i?void 0:i.query)&&void 0!==n?n:{};(null==i?void 0:i.redirectTo)&&(o.redirect_to=i.redirectTo);let a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=await e8(e,t,r+a,{headers:s,noResolveJson:null==i?void 0:i.noResolveJson},{},null==i?void 0:i.body);return(null==i?void 0:i.xform)?null==i?void 0:i.xform(l):{data:Object.assign({},l),error:null}}async function e8(e,t,r,i,n,s){let o;let a=e9(t,i,n,s);try{o=await e(r,a)}catch(e){throw console.error(e),new e0(e4(e),0)}if(o.ok||await e6(o),null==i?void 0:i.noResolveJson)return o;try{return await o.json()}catch(e){await e6(e)}}function te(e){var t,r;let i=null;return e.access_token&&e.refresh_token&&e.expires_in&&(i=Object.assign({},e),!e.expires_at)&&(i.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)),{data:{session:i,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function tt(e){let t=te(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function tr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function ti(e){return{data:e,error:null}}function tn(e){let{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:s}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:i,redirect_to:n,verification_type:s},user:Object.assign({},e3(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function ts(e){return e}var to=function(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var n=0,i=Object.getOwnPropertySymbols(e);n<i.length;n++)0>t.indexOf(i[n])&&Object.prototype.propertyIsEnumerable.call(e,i[n])&&(r[i[n]]=e[i[n]]);return r};class ta{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=eR(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await e7(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await e7(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:tr})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=to(e,["options"]),i=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(i.new_email=null==r?void 0:r.newEmail,delete i.newEmail),await e7(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:i,headers:this.headers,xform:tn,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(eJ(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await e7(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:tr})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,i,n,s,o,a;try{let l={nextPage:null,lastPage:0,total:0},c=await e7(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(r=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==r?r:"",per_page:null!==(n=null===(i=null==e?void 0:e.perPage)||void 0===i?void 0:i.toString())&&void 0!==n?n:""},xform:ts});if(c.error)throw c.error;let h=await c.json(),u=null!==(s=c.headers.get("x-total-count"))&&void 0!==s?s:0,d=null!==(a=null===(o=c.headers.get("link"))||void 0===o?void 0:o.split(","))&&void 0!==a?a:[];return d.length>0&&(d.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(u)),{data:Object.assign(Object.assign({},h),l),error:null}}catch(e){if(eJ(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){try{return await e7(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:tr})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){try{return await e7(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:tr})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){try{return await e7(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:tr})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){try{let{data:t,error:r}=await e7(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _deleteFactor(e){try{return{data:await e7(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}}let tl="0.0.0",tc={"X-Client-Info":`gotrue-js/${tl}`},th={getItem:e=>eC()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{eC()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{eC()&&globalThis.localStorage.removeItem(e)}};function tu(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let td={debug:!!(globalThis&&eC()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class tf extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class tp extends tf{}async function tg(e,t,r){td.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let i=new globalThis.AbortController;return t>0&&setTimeout(()=>{i.abort(),td.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:i.signal},async i=>{if(i){td.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,i.name);try{return await r()}finally{td.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,i.name)}}else{if(0===t)throw td.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new tp(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(td.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}})}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();let tm={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:tc,flowType:"implicit",debug:!1};async function ty(e,t,r){return await r()}class tv{constructor(e){var t,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=tv.nextInstanceID,tv.nextInstanceID+=1,this.instanceID>0&&eP()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");let i=Object.assign(Object.assign({},tm),e);if(this.logDebugMessages=!!i.debug,"function"==typeof i.debug&&(this.logger=i.debug),this.persistSession=i.persistSession,this.storageKey=i.storageKey,this.autoRefreshToken=i.autoRefreshToken,this.admin=new ta({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=eR(i.fetch),this.lock=i.lock||ty,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,i.lock?this.lock=i.lock:eP()&&(null===(t=null==globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=tg:this.lock=ty,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?i.storage?this.storage=i.storage:eC()?this.storage=th:(this.memoryStorage={},this.storage=tu(this.memoryStorage)):(this.memoryStorage={},this.storage=tu(this.memoryStorage)),eP()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null===(r=this.broadcastChannel)||void 0===r||r.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${tl}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){try{let e=!!eP()&&await this._isPKCEFlow();if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){let{data:t,error:r}=await this._getSessionFromURL(e);if(r){if(this._debug("#_initialize()","error detecting session from URL",r),(null==r?void 0:r.message)==="Identity is already linked"||(null==r?void 0:r.message)==="Identity is already linked to another user")return{error:r};return await this._removeSession(),{error:r}}let{session:i,redirectType:n}=t;return this._debug("#_initialize()","detected session in URL",i,"redirect type",n),await this._saveSession(i),setTimeout(async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(eJ(e))return{error:e};return{error:new eW("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,r,i;try{let n;if(await this._removeSession(),"email"in e){let{email:r,password:i,options:s}=e,o=null,a=null;if("pkce"===this.flowType){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,e),o=await eq(e),a=e===o?"plain":"s256"}n=await e7(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==s?void 0:s.emailRedirectTo,body:{email:r,password:i,data:null!==(t=null==s?void 0:s.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},code_challenge:o,code_challenge_method:a},xform:te})}else if("phone"in e){let{phone:t,password:s,options:o}=e;n=await e7(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:s,data:null!==(r=null==o?void 0:o.data)&&void 0!==r?r:{},channel:null!==(i=null==o?void 0:o.channel)&&void 0!==i?i:"sms",gotrue_meta_security:{captcha_token:null==o?void 0:o.captchaToken}},xform:te})}else throw new eZ("You must provide either an email or phone number and a password");let{data:s,error:o}=n;if(o||!s)return{data:{user:null,session:null},error:o};let a=s.session,l=s.user;return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithPassword(e){try{let t;if(await this._removeSession(),"email"in e){let{email:r,password:i,options:n}=e;t=await e7(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tt})}else if("phone"in e){let{phone:r,password:i,options:n}=e;t=await e7(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:tt})}else throw new eZ("You must provide either an email or phone number and a password");let{data:r,error:i}=t;if(i)return{data:{user:null,session:null},error:i};if(!r||!r.session||!r.user)return{data:{user:null,session:null},error:new eY};return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:i}}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOAuth(e){var t,r,i,n;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(i=e.options)||void 0===i?void 0:i.queryParams,skipBrowserRedirect:null===(n=e.options)||void 0===n?void 0:n.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){let t=await eI(this.storage,`${this.storageKey}-code-verifier`),[r,i]=(null!=t?t:"").split("/"),{data:n,error:s}=await e7(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:te});return(await eD(this.storage,`${this.storageKey}-code-verifier`),s)?{data:{user:null,session:null,redirectType:null},error:s}:n&&n.session&&n.user?(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign(Object.assign({},n),{redirectType:null!=i?i:null}),error:s}):{data:{user:null,session:null,redirectType:null},error:new eY}}async signInWithIdToken(e){await this._removeSession();try{let{options:t,provider:r,token:i,access_token:n,nonce:s}=e,{data:o,error:a}=await e7(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:i,access_token:n,nonce:s,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:te});if(a)return{data:{user:null,session:null},error:a};if(!o||!o.session||!o.user)return{data:{user:null,session:null},error:new eY};return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:a}}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithOtp(e){var t,r,i,n,s;try{if(await this._removeSession(),"email"in e){let{email:i,options:n}=e,s=null,o=null;if("pkce"===this.flowType){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,e),s=await eq(e),o=e===s?"plain":"s256"}let{error:a}=await e7(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:i,data:null!==(t=null==n?void 0:n.data)&&void 0!==t?t:{},create_user:null===(r=null==n?void 0:n.shouldCreateUser)||void 0===r||r,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken},code_challenge:s,code_challenge_method:o},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:a}}if("phone"in e){let{phone:t,options:r}=e,{data:o,error:a}=await e7(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(i=null==r?void 0:r.data)&&void 0!==i?i:{},create_user:null===(n=null==r?void 0:r.shouldCreateUser)||void 0===n||n,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!==(s=null==r?void 0:r.channel)&&void 0!==s?s:"sms"}});return{data:{user:null,session:null,messageId:null==o?void 0:o.message_id},error:a}}throw new eZ("You must provide either an email or phone number.")}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async verifyOtp(e){var t,r;try{let i,n;"email_change"!==e.type&&"phone_change"!==e.type&&await this._removeSession(),"options"in e&&(i=null===(t=e.options)||void 0===t?void 0:t.redirectTo,n=null===(r=e.options)||void 0===r?void 0:r.captchaToken);let{data:s,error:o}=await e7(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:n}}),redirectTo:i,xform:te});if(o)throw o;if(!s)throw Error("An error occurred on token verification.");let a=s.session,l=s.user;return(null==a?void 0:a.access_token)&&(await this._saveSession(a),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",a)),{data:{user:l,session:a},error:null}}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async signInWithSSO(e){var t,r,i;try{await this._removeSession();let n=null,s=null;if("pkce"===this.flowType){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,e),n=await eq(e),s=e===n?"plain":"s256"}return await e7(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==r?r:void 0}),(null===(i=null==e?void 0:e.options)||void 0===i?void 0:i.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:s}),headers:this.headers,xform:ti})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new eV;let{error:i}=await e7(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:i}})}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{"email_change"!=e.type&&"phone_change"!=e.type&&await this._removeSession();let t=`${this.url}/resend`;if("email"in e){let{email:r,type:i,options:n}=e,{error:s}=await e7(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},redirectTo:null==n?void 0:n.emailRedirectTo});return{data:{user:null,session:null},error:s}}if("phone"in e){let{phone:r,type:i,options:n}=e,{data:s,error:o}=await e7(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:i,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}}});return{data:{user:null,session:null,messageId:null==s?void 0:s.message_id},error:o}}throw new eZ("You must provide either an email or phone number and a type")}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async getSession(){return await this.initializePromise,this._acquireLock(-1,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let e=null,t=await eI(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};let r=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r)return{data:{session:e},error:null};let{session:i,error:n}=await this._callRefreshToken(e.refresh_token);if(n)return{data:{session:null},error:n};return{data:{session:i},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{if(e)return await e7(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:tr});return await this._useSession(async e=>{var t,r;let{data:i,error:n}=e;if(n)throw n;return await e7(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(t=i.session)||void 0===t?void 0:t.access_token)&&void 0!==r?r:void 0,xform:tr})})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:i,error:n}=r;if(n)throw n;if(!i.session)throw new eV;let s=i.session,o=null,a=null;if("pkce"===this.flowType&&null!=e.email){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,e),o=await eq(e),a=e===o?"plain":"s256"}let{data:l,error:c}=await e7(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:a}),jwt:s.access_token,xform:tr});if(c)throw c;return s.user=l.user,await this._saveSession(s),await this._notifyAllSubscribers("USER_UPDATED",s),{data:{user:s.user},error:null}})}catch(e){if(eJ(e))return{data:{user:null},error:e};throw e}}_decodeJWT(e){return eU(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new eV;let t=Date.now()/1e3,r=t,i=!0,n=null,s=eU(e.access_token);if(s.exp&&(i=(r=s.exp)<=t),i){let{session:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return{data:{user:null,session:null},error:r};if(!t)return{data:{user:null,session:null},error:null};n=t}else{let{data:i,error:s}=await this._getUser(e.access_token);if(s)throw s;n={access_token:e.access_token,refresh_token:e.refresh_token,user:i.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(n),await this._notifyAllSubscribers("SIGNED_IN",n)}return{data:{user:n.user,session:n},error:null}}catch(e){if(eJ(e))return{data:{session:null,user:null},error:e};throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:i,error:n}=t;if(n)throw n;e=null!==(r=i.session)&&void 0!==r?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new eV;let{session:i,error:n}=await this._callRefreshToken(e.refresh_token);return n?{data:{user:null,session:null},error:n}:i?{data:{user:i.user,session:i},error:null}:{data:{user:null,session:null},error:null}})}catch(e){if(eJ(e))return{data:{user:null,session:null},error:e};throw e}}async _getSessionFromURL(e){try{if(!eP())throw new eX("No browser detected.");if("implicit"!==this.flowType||this._isImplicitGrantFlow()){if("pkce"==this.flowType&&!e)throw new eQ("Not a valid PKCE flow url.")}else throw new eX("Not a valid implicit grant flow url.");let t=e$(window.location.href);if(e){if(!t.code)throw new eQ("No code detected.");let{data:e,error:r}=await this._exchangeCodeForSession(t.code);if(r)throw r;let i=new URL(window.location.href);return i.searchParams.delete("code"),window.history.replaceState(window.history.state,"",i.toString()),{data:{session:e.session,redirectType:null},error:null}}if(t.error||t.error_description||t.error_code)throw new eX(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});let{provider_token:r,provider_refresh_token:i,access_token:n,refresh_token:s,expires_in:o,expires_at:a,token_type:l}=t;if(!n||!o||!s||!l)throw new eX("No session defined in URL");let c=Math.round(Date.now()/1e3),h=parseInt(o),u=c+h;a&&(u=parseInt(a));let d=u-c;1e3*d<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${d}s, should have been closer to ${h}s`);let f=u-h;c-f>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",f,u,c):c-f<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clok for skew",f,u,c);let{data:p,error:g}=await this._getUser(n);if(g)throw g;let m={provider_token:r,provider_refresh_token:i,access_token:n,expires_in:h,expires_at:u,refresh_token:s,token_type:l,user:p.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:m,redirectType:t.type},error:null}}catch(e){if(eJ(e))return{data:{session:null,redirectType:null},error:e};throw e}}_isImplicitGrantFlow(){let e=e$(window.location.href);return!!(eP()&&(e.access_token||e.error_description))}async _isPKCEFlow(){let e=e$(window.location.href),t=await eI(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return{error:n};let s=null===(r=i.session)||void 0===r?void 0:r.access_token;if(s){let{error:t}=await this.admin.signOut(s,e);if(t&&!(eJ(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status)))return{error:t}}return"others"!==e&&(await this._removeSession(),await eD(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}})}onAuthStateChange(e){let t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,i;try{let{data:{session:i},error:n}=t;if(n)throw n;await (null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(t){await (null===(i=this.stateChangeEmitters.get(e))||void 0===i?void 0:i.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,i=null;if("pkce"===this.flowType){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,`${e}/PASSWORD_RECOVERY`),r=await eq(e),i=e===r?"plain":"s256"}try{return await e7(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:i,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async linkIdentity(e){var t;try{let{data:r,error:i}=await this._useSession(async t=>{var r,i,n,s,o;let{data:a,error:l}=t;if(l)throw l;let c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(r=e.options)||void 0===r?void 0:r.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(n=e.options)||void 0===n?void 0:n.queryParams,skipBrowserRedirect:!0});return await e7(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(o=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==o?o:void 0})});if(i)throw i;return!eP()||(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),{data:{provider:e.provider,url:null==r?void 0:r.url},error:null}}catch(t){if(eJ(t))return{data:{provider:e.provider,url:null},error:t};throw t}}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:s}=t;if(s)throw s;return await e7(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(i=null===(r=n.session)||void 0===r?void 0:r.access_token)&&void 0!==i?i:void 0})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,i;let n=Date.now();return await (r=async r=>(await eF(200*r),this._debug(t,"refreshing attempt",r),await e7(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:te})),i=(e,t,r)=>r&&r.error&&e1(r.error)&&Date.now()+(e+1)*200-n<3e4,new Promise((e,t)=>{(async()=>{for(let n=0;n<1/0;n++)try{let t=await r(n);if(!i(n,null,t)){e(t);return}}catch(e){if(!i(n,e)){t(e);return}}})()}))}catch(e){if(this._debug(t,"error",e),eJ(e))return{data:{session:null,user:null},error:e};throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),eP()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;let t="#_recoverAndRefresh()";this._debug(t,"begin");try{let r=await eI(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),null!==r&&await this._removeSession();return}let i=Math.round(Date.now()/1e3),n=(null!==(e=r.expires_at)&&void 0!==e?e:1/0)<i+10;if(this._debug(t,`session has${n?"":" not"} expired with margin of 10s`),n){if(this.autoRefreshToken&&r.refresh_token){let{error:e}=await this._callRefreshToken(r.refresh_token);e&&(console.error(e),e1(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(e){this._debug(t,"error",e),console.error(e);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new eV;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let i=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(i,"begin");try{this.refreshingDeferred=new eN;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new eV;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let i={session:t.session,error:null};return this.refreshingDeferred.resolve(i),i}catch(e){if(this._debug(i,"error",e),eJ(e)){let r={session:null,error:e};return e1(e)||(await this._removeSession(),await this._notifyAllSubscribers("SIGNED_OUT",null)),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(r),r}throw null===(r=this.refreshingDeferred)||void 0===r||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(i,"end")}}async _notifyAllSubscribers(e,t,r=!0){let i=`#_notifyAllSubscribers(${e})`;this._debug(i,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let i=[],n=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){i.push(e)}});if(await Promise.all(n),i.length>0){for(let e=0;e<i.length;e+=1)console.error(i[e]);throw i[0]}}finally{this._debug(i,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),await eL(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await eD(this.storage,this.storageKey)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&eP()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}let i=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${i} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),i<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof tf)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!eP()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if("visible"!==document.visibilityState){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let i=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&i.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&i.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let e=ez();await eL(this.storage,`${this.storageKey}-code-verifier`,e);let t=await eq(e),r=e===t?"plain":"s256";this._debug("PKCE","code verifier",`${e.substring(0,5)}...`,"code challenge",t,"method",r);let n=new URLSearchParams({code_challenge:`${encodeURIComponent(t)}`,code_challenge_method:`${encodeURIComponent(r)}`});i.push(n.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);i.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&i.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${i.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;return n?{data:null,error:n}:await e7(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,i;let{data:n,error:s}=t;if(s)return{data:null,error:s};let{data:o,error:a}=await e7(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:null===(r=null==n?void 0:n.session)||void 0===r?void 0:r.access_token});return a?{data:null,error:a}:((null===(i=null==o?void 0:o.totp)||void 0===i?void 0:i.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;if(n)return{data:null,error:n};let{data:s,error:o}=await e7(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+s.expires_in},s)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",s),{data:s,error:o})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;let{data:i,error:n}=t;return n?{data:null,error:n}:await e7(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:null===(r=null==i?void 0:i.session)||void 0===r?void 0:r.access_token})})}catch(e){if(eJ(e))return{data:null,error:e};throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){let{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};let r=(null==e?void 0:e.factors)||[],i=r.filter(e=>"totp"===e.factor_type&&"verified"===e.status);return{data:{all:r,totp:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var t,r;let{data:{session:i},error:n}=e;if(n)return{data:null,error:n};if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let s=this._decodeJWT(i.access_token),o=null;s.aal&&(o=s.aal);let a=o;return(null!==(r=null===(t=i.user.factors)||void 0===t?void 0:t.filter(e=>"verified"===e.status))&&void 0!==r?r:[]).length>0&&(a="aal2"),{data:{currentLevel:o,nextLevel:a,currentAuthenticationMethods:s.amr||[]},error:null}}))}}tv.nextInstanceID=0;class tw extends tv{constructor(e){super(e)}}let tb={headers:ex},t_={schema:"public"},tk={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},tT={};class tx{constructor(e,t,r){var i,n,s,o,a,l,c,h;if(this.supabaseUrl=e,this.supabaseKey=t,this.from=e=>this.rest.from(e),this.schema=e=>this.rest.schema(e),this.rpc=(e,t={},r)=>this.rest.rpc(e,t,r),!e)throw Error("supabaseUrl is required.");if(!t)throw Error("supabaseKey is required.");let u=e.replace(/\/$/,"");this.realtimeUrl=`${u}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${u}/auth/v1`,this.storageUrl=`${u}/storage/v1`,this.functionsUrl=`${u}/functions/v1`;let d=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f=function(e,t){let{db:r,auth:i,realtime:n,global:s}=e,{db:o,auth:a,realtime:l,global:c}=t;return{db:Object.assign(Object.assign({},o),r),auth:Object.assign(Object.assign({},a),i),realtime:Object.assign(Object.assign({},l),n),global:Object.assign(Object.assign({},c),s)}}(null!=r?r:{},{db:t_,realtime:tT,auth:Object.assign(Object.assign({},tk),{storageKey:d}),global:tb});this.storageKey=null!==(n=null===(i=f.auth)||void 0===i?void 0:i.storageKey)&&void 0!==n?n:"",this.headers=null!==(o=null===(s=f.global)||void 0===s?void 0:s.headers)&&void 0!==o?o:{},this.auth=this._initSupabaseAuthClient(null!==(a=f.auth)&&void 0!==a?a:{},this.headers,null===(l=f.global)||void 0===l?void 0:l.fetch),this.fetch=eO(t,this._getAccessToken.bind(this),null===(c=f.global)||void 0===c?void 0:c.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},f.realtime)),this.rest=new I(`${u}/rest/v1`,{headers:this.headers,schema:null===(h=f.db)||void 0===h?void 0:h.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new l(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new ek(this.storageUrl,this.headers,this.fetch)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t,r,i,n,s;return r=this,i=void 0,n=void 0,s=function*(){let{data:r}=yield this.auth.getSession();return null!==(t=null===(e=r.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null},new(n||(n=Promise))(function(e,t){function o(e){try{l(s.next(e))}catch(e){t(e)}}function a(e){try{l(s.throw(e))}catch(e){t(e)}}function l(t){var r;t.done?e(t.value):((r=t.value)instanceof n?r:new n(function(e){e(r)})).then(o,a)}l((s=s.apply(r,i||[])).next())})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,storageKey:n,flowType:s,debug:o},a,l){let c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new tw({url:this.authUrl,headers:Object.assign(Object.assign({},c),a),storageKey:n,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:i,flowType:s,debug:o,fetch:l})}_initRealtimeClient(e){return new Q(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.realtime.setAuth(null!=r?r:null),this.changedAccessToken=r):"SIGNED_OUT"===e&&(this.realtime.setAuth(this.supabaseKey),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}}let tS=(e,t,r)=>new tx(e,t,r)},7667:function(e,t,r){r.d(t,{VY:function(){return e9},zt:function(){return e4},fC:function(){return e5},xz:function(){return e6}});var i=r(7462),n=r(7294),s=r(6206),o=r(8771),a=r(5360),l=r(6063),c=r(1276);let h=["top","right","bottom","left"],u=Math.min,d=Math.max,f=Math.round,p=Math.floor,g=e=>({x:e,y:e}),m={left:"right",right:"left",bottom:"top",top:"bottom"},y={start:"end",end:"start"};function v(e,t){return"function"==typeof e?e(t):e}function w(e){return e.split("-")[0]}function b(e){return e.split("-")[1]}function _(e){return"x"===e?"y":"x"}function k(e){return"y"===e?"height":"width"}function T(e){return["top","bottom"].includes(w(e))?"y":"x"}function x(e){return e.replace(/start|end/g,e=>y[e])}function S(e){return e.replace(/left|right|bottom|top/g,e=>m[e])}function E(e){return"number"!=typeof e?{top:0,right:0,bottom:0,left:0,...e}:{top:e,right:e,bottom:e,left:e}}function O(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function P(e,t,r){let i,{reference:n,floating:s}=e,o=T(t),a=_(T(t)),l=k(a),c=w(t),h="y"===o,u=n.x+n.width/2-s.width/2,d=n.y+n.height/2-s.height/2,f=n[l]/2-s[l]/2;switch(c){case"top":i={x:u,y:n.y-s.height};break;case"bottom":i={x:u,y:n.y+n.height};break;case"right":i={x:n.x+n.width,y:d};break;case"left":i={x:n.x-s.width,y:d};break;default:i={x:n.x,y:n.y}}switch(b(t)){case"start":i[a]-=f*(r&&h?-1:1);break;case"end":i[a]+=f*(r&&h?-1:1)}return i}let j=async(e,t,r)=>{let{placement:i="bottom",strategy:n="absolute",middleware:s=[],platform:o}=r,a=s.filter(Boolean),l=await (null==o.isRTL?void 0:o.isRTL(t)),c=await o.getElementRects({reference:e,floating:t,strategy:n}),{x:h,y:u}=P(c,i,l),d=i,f={},p=0;for(let r=0;r<a.length;r++){let{name:s,fn:g}=a[r],{x:m,y:y,data:v,reset:w}=await g({x:h,y:u,initialPlacement:i,placement:d,strategy:n,middlewareData:f,rects:c,platform:o,elements:{reference:e,floating:t}});if(h=null!=m?m:h,u=null!=y?y:u,f={...f,[s]:{...f[s],...v}},w&&p<=50){p++,"object"==typeof w&&(w.placement&&(d=w.placement),w.rects&&(c=!0===w.rects?await o.getElementRects({reference:e,floating:t,strategy:n}):w.rects),{x:h,y:u}=P(c,d,l)),r=-1;continue}}return{x:h,y:u,placement:d,strategy:n,middlewareData:f}};async function C(e,t){var r;void 0===t&&(t={});let{x:i,y:n,platform:s,rects:o,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:h="viewport",elementContext:u="floating",altBoundary:d=!1,padding:f=0}=v(t,e),p=E(f),g=a[d?"floating"===u?"reference":"floating":u],m=O(await s.getClippingRect({element:null==(r=await (null==s.isElement?void 0:s.isElement(g)))||r?g:g.contextElement||await (null==s.getDocumentElement?void 0:s.getDocumentElement(a.floating)),boundary:c,rootBoundary:h,strategy:l})),y="floating"===u?{...o.floating,x:i,y:n}:o.reference,w=await (null==s.getOffsetParent?void 0:s.getOffsetParent(a.floating)),b=await (null==s.isElement?void 0:s.isElement(w))&&await (null==s.getScale?void 0:s.getScale(w))||{x:1,y:1},_=O(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({rect:y,offsetParent:w,strategy:l}):y);return{top:(m.top-_.top+p.top)/b.y,bottom:(_.bottom-m.bottom+p.bottom)/b.y,left:(m.left-_.left+p.left)/b.x,right:(_.right-m.right+p.right)/b.x}}function $(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function R(e){return h.some(t=>e[t]>=0)}async function A(e,t){let{placement:r,platform:i,elements:n}=e,s=await (null==i.isRTL?void 0:i.isRTL(n.floating)),o=w(r),a=b(r),l="y"===T(r),c=["left","top"].includes(o)?-1:1,h=s&&l?-1:1,u=v(t,e),{mainAxis:d,crossAxis:f,alignmentAxis:p}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...u};return a&&"number"==typeof p&&(f="end"===a?-1*p:p),l?{x:f*h,y:d*c}:{x:d*c,y:f*h}}function L(e){return N(e)?(e.nodeName||"").toLowerCase():"#document"}function I(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function D(e){var t;return null==(t=(N(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function N(e){return e instanceof Node||e instanceof I(e).Node}function U(e){return e instanceof Element||e instanceof I(e).Element}function F(e){return e instanceof HTMLElement||e instanceof I(e).HTMLElement}function M(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof I(e).ShadowRoot)}function z(e){let{overflow:t,overflowX:r,overflowY:i,display:n}=J(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+r)&&!["inline","contents"].includes(n)}function B(e){let t=q(),r=J(e);return"none"!==r.transform||"none"!==r.perspective||!!r.containerType&&"normal"!==r.containerType||!t&&!!r.backdropFilter&&"none"!==r.backdropFilter||!t&&!!r.filter&&"none"!==r.filter||["transform","perspective","filter"].some(e=>(r.willChange||"").includes(e))||["paint","layout","strict","content"].some(e=>(r.contain||"").includes(e))}function q(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function H(e){return["html","body","#document"].includes(L(e))}function J(e){return I(e).getComputedStyle(e)}function K(e){return U(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function W(e){if("html"===L(e))return e;let t=e.assignedSlot||e.parentNode||M(e)&&e.host||D(e);return M(t)?t.host:t}function G(e,t,r){var i;void 0===t&&(t=[]),void 0===r&&(r=!0);let n=function e(t){let r=W(t);return H(r)?t.ownerDocument?t.ownerDocument.body:t.body:F(r)&&z(r)?r:e(r)}(e),s=n===(null==(i=e.ownerDocument)?void 0:i.body),o=I(n);return s?t.concat(o,o.visualViewport||[],z(n)?n:[],o.frameElement&&r?G(o.frameElement):[]):t.concat(n,G(n,[],r))}function V(e){let t=J(e),r=parseFloat(t.width)||0,i=parseFloat(t.height)||0,n=F(e),s=n?e.offsetWidth:r,o=n?e.offsetHeight:i,a=f(r)!==s||f(i)!==o;return a&&(r=s,i=o),{width:r,height:i,$:a}}function Y(e){return U(e)?e:e.contextElement}function Z(e){let t=Y(e);if(!F(t))return g(1);let r=t.getBoundingClientRect(),{width:i,height:n,$:s}=V(t),o=(s?f(r.width):r.width)/i,a=(s?f(r.height):r.height)/n;return o&&Number.isFinite(o)||(o=1),a&&Number.isFinite(a)||(a=1),{x:o,y:a}}let X=g(0);function Q(e){let t=I(e);return q()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:X}function ee(e,t,r,i){var n;void 0===t&&(t=!1),void 0===r&&(r=!1);let s=e.getBoundingClientRect(),o=Y(e),a=g(1);t&&(i?U(i)&&(a=Z(i)):a=Z(e));let l=(void 0===(n=r)&&(n=!1),i&&(!n||i===I(o))&&n)?Q(o):g(0),c=(s.left+l.x)/a.x,h=(s.top+l.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(o){let e=I(o),t=i&&U(i)?I(i):i,r=e.frameElement;for(;r&&i&&t!==e;){let e=Z(r),t=r.getBoundingClientRect(),i=J(r),n=t.left+(r.clientLeft+parseFloat(i.paddingLeft))*e.x,s=t.top+(r.clientTop+parseFloat(i.paddingTop))*e.y;c*=e.x,h*=e.y,u*=e.x,d*=e.y,c+=n,h+=s,r=I(r).frameElement}}return O({width:u,height:d,x:c,y:h})}function et(e){return ee(D(e)).left+K(e).scrollLeft}function er(e,t,r){let i;if("viewport"===t)i=function(e,t){let r=I(e),i=D(e),n=r.visualViewport,s=i.clientWidth,o=i.clientHeight,a=0,l=0;if(n){s=n.width,o=n.height;let e=q();(!e||e&&"fixed"===t)&&(a=n.offsetLeft,l=n.offsetTop)}return{width:s,height:o,x:a,y:l}}(e,r);else if("document"===t)i=function(e){let t=D(e),r=K(e),i=e.ownerDocument.body,n=d(t.scrollWidth,t.clientWidth,i.scrollWidth,i.clientWidth),s=d(t.scrollHeight,t.clientHeight,i.scrollHeight,i.clientHeight),o=-r.scrollLeft+et(e),a=-r.scrollTop;return"rtl"===J(i).direction&&(o+=d(t.clientWidth,i.clientWidth)-n),{width:n,height:s,x:o,y:a}}(D(e));else if(U(t))i=function(e,t){let r=ee(e,!0,"fixed"===t),i=r.top+e.clientTop,n=r.left+e.clientLeft,s=F(e)?Z(e):g(1),o=e.clientWidth*s.x;return{width:o,height:e.clientHeight*s.y,x:n*s.x,y:i*s.y}}(t,r);else{let r=Q(e);i={...t,x:t.x-r.x,y:t.y-r.y}}return O(i)}function ei(e,t){return F(e)&&"fixed"!==J(e).position?t?t(e):e.offsetParent:null}function en(e,t){let r=I(e);if(!F(e))return r;let i=ei(e,t);for(;i&&["table","td","th"].includes(L(i))&&"static"===J(i).position;)i=ei(i,t);return i&&("html"===L(i)||"body"===L(i)&&"static"===J(i).position&&!B(i))?r:i||function(e){let t=W(e);for(;F(t)&&!H(t);){if(B(t))return t;t=W(t)}return null}(e)||r}let es=async function(e){let{reference:t,floating:r,strategy:i}=e,n=this.getOffsetParent||en,s=this.getDimensions;return{reference:function(e,t,r){let i=F(t),n=D(t),s="fixed"===r,o=ee(e,!0,s,t),a={scrollLeft:0,scrollTop:0},l=g(0);if(i||!i&&!s){if(("body"!==L(t)||z(n))&&(a=K(t)),i){let e=ee(t,!0,s,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else n&&(l.x=et(n))}return{x:o.left+a.scrollLeft-l.x,y:o.top+a.scrollTop-l.y,width:o.width,height:o.height}}(t,await n(r),i),floating:{x:0,y:0,...await s(r)}}},eo={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:r,strategy:i}=e,n=F(r),s=D(r);if(r===s)return t;let o={scrollLeft:0,scrollTop:0},a=g(1),l=g(0);if((n||!n&&"fixed"!==i)&&(("body"!==L(r)||z(s))&&(o=K(r)),F(r))){let e=ee(r);a=Z(r),l.x=e.x+r.clientLeft,l.y=e.y+r.clientTop}return{width:t.width*a.x,height:t.height*a.y,x:t.x*a.x-o.scrollLeft*a.x+l.x,y:t.y*a.y-o.scrollTop*a.y+l.y}},getDocumentElement:D,getClippingRect:function(e){let{element:t,boundary:r,rootBoundary:i,strategy:n}=e,s=[..."clippingAncestors"===r?function(e,t){let r=t.get(e);if(r)return r;let i=G(e,[],!1).filter(e=>U(e)&&"body"!==L(e)),n=null,s="fixed"===J(e).position,o=s?W(e):e;for(;U(o)&&!H(o);){let t=J(o),r=B(o);r||"fixed"!==t.position||(n=null),(s?!r&&!n:!r&&"static"===t.position&&!!n&&["absolute","fixed"].includes(n.position)||z(o)&&!r&&function e(t,r){let i=W(t);return!(i===r||!U(i)||H(i))&&("fixed"===J(i).position||e(i,r))}(e,o))?i=i.filter(e=>e!==o):n=t,o=W(o)}return t.set(e,i),i}(t,this._c):[].concat(r),i],o=s[0],a=s.reduce((e,r)=>{let i=er(t,r,n);return e.top=d(i.top,e.top),e.right=u(i.right,e.right),e.bottom=u(i.bottom,e.bottom),e.left=d(i.left,e.left),e},er(t,o,n));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:en,getElementRects:es,getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){let{width:t,height:r}=V(e);return{width:t,height:r}},getScale:Z,isElement:U,isRTL:function(e){return"rtl"===J(e).direction}},ea=e=>({name:"arrow",options:e,async fn(t){let{x:r,y:i,placement:n,rects:s,platform:o,elements:a,middlewareData:l}=t,{element:c,padding:h=0}=v(e,t)||{};if(null==c)return{};let f=E(h),p={x:r,y:i},g=_(T(n)),m=k(g),y=await o.getDimensions(c),w="y"===g,x=w?"clientHeight":"clientWidth",S=s.reference[m]+s.reference[g]-p[g]-s.floating[m],O=p[g]-s.reference[g],P=await (null==o.getOffsetParent?void 0:o.getOffsetParent(c)),j=P?P[x]:0;j&&await (null==o.isElement?void 0:o.isElement(P))||(j=a.floating[x]||s.floating[m]);let C=j/2-y[m]/2-1,$=u(f[w?"top":"left"],C),R=u(f[w?"bottom":"right"],C),A=j-y[m]-R,L=j/2-y[m]/2+(S/2-O/2),I=d($,u(L,A)),D=!l.arrow&&null!=b(n)&&L!=I&&s.reference[m]/2-(L<$?$:R)-y[m]/2<0,N=D?L<$?L-$:L-A:0;return{[g]:p[g]+N,data:{[g]:I,centerOffset:L-I-N,...D&&{alignmentOffset:N}},reset:D}}}),el=(e,t,r)=>{let i=new Map,n={platform:eo,...r},s={...n.platform,_c:i};return j(e,t,{...n,platform:s})};var ec=r(3935);let eh=e=>({name:"arrow",options:e,fn(t){let{element:r,padding:i}="function"==typeof e?e(t):e;return r&&({}).hasOwnProperty.call(r,"current")?null!=r.current?ea({element:r.current,padding:i}).fn(t):{}:r?ea({element:r,padding:i}).fn(t):{}}});var eu="undefined"!=typeof document?n.useLayoutEffect:n.useEffect;function ed(e,t){let r,i,n;if(e===t)return!0;if(typeof e!=typeof t)return!1;if("function"==typeof e&&e.toString()===t.toString())return!0;if(e&&t&&"object"==typeof e){if(Array.isArray(e)){if((r=e.length)!==t.length)return!1;for(i=r;0!=i--;)if(!ed(e[i],t[i]))return!1;return!0}if((r=(n=Object.keys(e)).length)!==Object.keys(t).length)return!1;for(i=r;0!=i--;)if(!({}).hasOwnProperty.call(t,n[i]))return!1;for(i=r;0!=i--;){let r=n[i];if(("_owner"!==r||!e.$$typeof)&&!ed(e[r],t[r]))return!1}return!0}return e!=e&&t!=t}function ef(e){return"undefined"==typeof window?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function ep(e,t){let r=ef(e);return Math.round(t*r)/r}function eg(e){let t=n.useRef(e);return eu(()=>{t.current=e}),t}var em=r(5320);let ey=(0,n.forwardRef)((e,t)=>{let{children:r,width:s=10,height:o=5,...a}=e;return(0,n.createElement)(em.WV.svg,(0,i.Z)({},a,{ref:t,width:s,height:o,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),e.asChild?r:(0,n.createElement)("polygon",{points:"0,0 30,0 15,10"}))});var ev=r(9698),ew=r(9981);let eb="Popper",[e_,ek]=(0,a.b)(eb),[eT,ex]=e_(eb),eS=(0,n.forwardRef)((e,t)=>{let{__scopePopper:r,virtualRef:s,...a}=e,l=ex("PopperAnchor",r),c=(0,n.useRef)(null),h=(0,o.e)(t,c);return(0,n.useEffect)(()=>{l.onAnchorChange((null==s?void 0:s.current)||c.current)}),s?null:(0,n.createElement)(em.WV.div,(0,i.Z)({},a,{ref:h}))}),eE="PopperContent",[eO,eP]=e_(eE),ej=(0,n.forwardRef)((e,t)=>{var r,s,a,l,c,h,f,g,m,y,E,O,P,j;let{__scopePopper:L,side:I="bottom",sideOffset:N=0,align:U="center",alignOffset:F=0,arrowPadding:M=0,avoidCollisions:z=!0,collisionBoundary:B=[],collisionPadding:q=0,sticky:H="partial",hideWhenDetached:J=!1,updatePositionStrategy:K="optimized",onPlaced:W,...V}=e,Z=ex(eE,L),[X,Q]=(0,n.useState)(null),et=(0,o.e)(t,e=>Q(e)),[er,ei]=(0,n.useState)(null),en=function(e){let[t,r]=(0,n.useState)(void 0);return(0,ew.b)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let i,n;if(!Array.isArray(t)||!t.length)return;let s=t[0];if("borderBoxSize"in s){let e=s.borderBoxSize,t=Array.isArray(e)?e[0]:e;i=t.inlineSize,n=t.blockSize}else i=e.offsetWidth,n=e.offsetHeight;r({width:i,height:n})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(er),es=null!==(r=null==en?void 0:en.width)&&void 0!==r?r:0,eo=null!==(s=null==en?void 0:en.height)&&void 0!==s?s:0,ea="number"==typeof q?q:{top:0,right:0,bottom:0,left:0,...q},ey=Array.isArray(B)?B:[B],eb=ey.length>0,e_={padding:ea,boundary:ey.filter(e$),altBoundary:eb},{refs:ek,floatingStyles:eT,placement:eS,isPositioned:eP,middlewareData:ej}=function(e){void 0===e&&(e={});let{placement:t="bottom",strategy:r="absolute",middleware:i=[],platform:s,elements:{reference:o,floating:a}={},transform:l=!0,whileElementsMounted:c,open:h}=e,[u,d]=n.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[f,p]=n.useState(i);ed(f,i)||p(i);let[g,m]=n.useState(null),[y,v]=n.useState(null),w=n.useCallback(e=>{e!==T.current&&(T.current=e,m(e))},[]),b=n.useCallback(e=>{e!==x.current&&(x.current=e,v(e))},[]),_=o||g,k=a||y,T=n.useRef(null),x=n.useRef(null),S=n.useRef(u),E=null!=c,O=eg(c),P=eg(s),j=n.useCallback(()=>{if(!T.current||!x.current)return;let e={placement:t,strategy:r,middleware:f};P.current&&(e.platform=P.current),el(T.current,x.current,e).then(e=>{let t={...e,isPositioned:!0};C.current&&!ed(S.current,t)&&(S.current=t,ec.flushSync(()=>{d(t)}))})},[f,t,r,P]);eu(()=>{!1===h&&S.current.isPositioned&&(S.current.isPositioned=!1,d(e=>({...e,isPositioned:!1})))},[h]);let C=n.useRef(!1);eu(()=>(C.current=!0,()=>{C.current=!1}),[]),eu(()=>{if(_&&(T.current=_),k&&(x.current=k),_&&k){if(O.current)return O.current(_,k,j);j()}},[_,k,j,O,E]);let $=n.useMemo(()=>({reference:T,floating:x,setReference:w,setFloating:b}),[w,b]),R=n.useMemo(()=>({reference:_,floating:k}),[_,k]),A=n.useMemo(()=>{let e={position:r,left:0,top:0};if(!R.floating)return e;let t=ep(R.floating,u.x),i=ep(R.floating,u.y);return l?{...e,transform:"translate("+t+"px, "+i+"px)",...ef(R.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:t,top:i}},[r,l,R.floating,u.x,u.y]);return n.useMemo(()=>({...u,update:j,refs:$,elements:R,floatingStyles:A}),[u,j,$,R,A])}({strategy:"fixed",placement:I+("center"!==U?"-"+U:""),whileElementsMounted:(...e)=>(function(e,t,r,i){let n;void 0===i&&(i={});let{ancestorScroll:s=!0,ancestorResize:o=!0,elementResize:a="function"==typeof ResizeObserver,layoutShift:l="function"==typeof IntersectionObserver,animationFrame:c=!1}=i,h=Y(e),f=s||o?[...h?G(h):[],...G(t)]:[];f.forEach(e=>{s&&e.addEventListener("scroll",r,{passive:!0}),o&&e.addEventListener("resize",r)});let g=h&&l?function(e,t){let r,i=null,n=D(e);function s(){clearTimeout(r),i&&i.disconnect(),i=null}return!function o(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),s();let{left:c,top:h,width:f,height:g}=e.getBoundingClientRect();if(a||t(),!f||!g)return;let m=p(h),y=p(n.clientWidth-(c+f)),v={rootMargin:-m+"px "+-y+"px "+-p(n.clientHeight-(h+g))+"px "+-p(c)+"px",threshold:d(0,u(1,l))||1},w=!0;function b(e){let t=e[0].intersectionRatio;if(t!==l){if(!w)return o();t?o(!1,t):r=setTimeout(()=>{o(!1,1e-7)},100)}w=!1}try{i=new IntersectionObserver(b,{...v,root:n.ownerDocument})}catch(e){i=new IntersectionObserver(b,v)}i.observe(e)}(!0),s}(h,r):null,m=-1,y=null;a&&(y=new ResizeObserver(e=>{let[i]=e;i&&i.target===h&&y&&(y.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{y&&y.observe(t)})),r()}),h&&!c&&y.observe(h),y.observe(t));let v=c?ee(e):null;return c&&function t(){let i=ee(e);v&&(i.x!==v.x||i.y!==v.y||i.width!==v.width||i.height!==v.height)&&r(),v=i,n=requestAnimationFrame(t)}(),r(),()=>{f.forEach(e=>{s&&e.removeEventListener("scroll",r),o&&e.removeEventListener("resize",r)}),g&&g(),y&&y.disconnect(),y=null,c&&cancelAnimationFrame(n)}})(...e,{animationFrame:"always"===K}),elements:{reference:Z.anchor},middleware:[{name:"offset",options:m={mainAxis:N+eo,alignmentAxis:F},async fn(e){var t,r;let{x:i,y:n,placement:s,middlewareData:o}=e,a=await A(e,m);return s===(null==(t=o.offset)?void 0:t.placement)&&null!=(r=o.arrow)&&r.alignmentOffset?{}:{x:i+a.x,y:n+a.y,data:{...a,placement:s}}}},z&&{name:"shift",options:E={mainAxis:!0,crossAxis:!1,limiter:"partial"===H?(void 0===y&&(y={}),{options:y,fn(e){let{x:t,y:r,placement:i,rects:n,middlewareData:s}=e,{offset:o=0,mainAxis:a=!0,crossAxis:l=!0}=v(y,e),c={x:t,y:r},h=T(i),u=_(h),d=c[u],f=c[h],p=v(o,e),g="number"==typeof p?{mainAxis:p,crossAxis:0}:{mainAxis:0,crossAxis:0,...p};if(a){let e="y"===u?"height":"width",t=n.reference[u]-n.floating[e]+g.mainAxis,r=n.reference[u]+n.reference[e]-g.mainAxis;d<t?d=t:d>r&&(d=r)}if(l){var m,b;let e="y"===u?"width":"height",t=["top","left"].includes(w(i)),r=n.reference[h]-n.floating[e]+(t&&(null==(m=s.offset)?void 0:m[h])||0)+(t?0:g.crossAxis),o=n.reference[h]+n.reference[e]+(t?0:(null==(b=s.offset)?void 0:b[h])||0)-(t?g.crossAxis:0);f<r?f=r:f>o&&(f=o)}return{[u]:d,[h]:f}}}):void 0,...e_},async fn(e){let{x:t,y:r,placement:i}=e,{mainAxis:n=!0,crossAxis:s=!1,limiter:o={fn:e=>{let{x:t,y:r}=e;return{x:t,y:r}}},...a}=v(E,e),l={x:t,y:r},c=await C(e,a),h=T(w(i)),f=_(h),p=l[f],g=l[h];if(n){let e="y"===f?"top":"left",t="y"===f?"bottom":"right",r=p+c[e],i=p-c[t];p=d(r,u(p,i))}if(s){let e="y"===h?"top":"left",t="y"===h?"bottom":"right",r=g+c[e],i=g-c[t];g=d(r,u(g,i))}let m=o.fn({...e,[f]:p,[h]:g});return{...m,data:{x:m.x-t,y:m.y-r}}}},z&&{name:"flip",options:O={...e_},async fn(e){var t,r,i,n,s;let{placement:o,middlewareData:a,rects:l,initialPlacement:c,platform:h,elements:u}=e,{mainAxis:d=!0,crossAxis:f=!0,fallbackPlacements:p,fallbackStrategy:g="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...E}=v(O,e);if(null!=(t=a.arrow)&&t.alignmentOffset)return{};let P=w(o),j=w(c)===c,$=await (null==h.isRTL?void 0:h.isRTL(u.floating)),R=p||(j||!y?[S(c)]:function(e){let t=S(e);return[x(e),t,x(t)]}(c));p||"none"===m||R.push(...function(e,t,r,i){let n=b(e),s=function(e,t,r){let i=["left","right"],n=["right","left"];switch(e){case"top":case"bottom":if(r)return t?n:i;return t?i:n;case"left":case"right":return t?["top","bottom"]:["bottom","top"];default:return[]}}(w(e),"start"===r,i);return n&&(s=s.map(e=>e+"-"+n),t&&(s=s.concat(s.map(x)))),s}(c,y,m,$));let A=[c,...R],L=await C(e,E),I=[],D=(null==(r=a.flip)?void 0:r.overflows)||[];if(d&&I.push(L[P]),f){let e=function(e,t,r){void 0===r&&(r=!1);let i=b(e),n=_(T(e)),s=k(n),o="x"===n?i===(r?"end":"start")?"right":"left":"start"===i?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=S(o)),[o,S(o)]}(o,l,$);I.push(L[e[0]],L[e[1]])}if(D=[...D,{placement:o,overflows:I}],!I.every(e=>e<=0)){let e=((null==(i=a.flip)?void 0:i.index)||0)+1,t=A[e];if(t)return{data:{index:e,overflows:D},reset:{placement:t}};let r=null==(n=D.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:n.placement;if(!r)switch(g){case"bestFit":{let e=null==(s=D.map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:s[0];e&&(r=e);break}case"initialPlacement":r=c}if(o!==r)return{reset:{placement:r}}}return{}}},{name:"size",options:P={...e_,apply:({elements:e,rects:t,availableWidth:r,availableHeight:i})=>{let{width:n,height:s}=t.reference,o=e.floating.style;o.setProperty("--radix-popper-available-width",`${r}px`),o.setProperty("--radix-popper-available-height",`${i}px`),o.setProperty("--radix-popper-anchor-width",`${n}px`),o.setProperty("--radix-popper-anchor-height",`${s}px`)}},async fn(e){let t,r;let{placement:i,rects:n,platform:s,elements:o}=e,{apply:a=()=>{},...l}=v(P,e),c=await C(e,l),h=w(i),f=b(i),p="y"===T(i),{width:g,height:m}=n.floating;"top"===h||"bottom"===h?(t=h,r=f===(await (null==s.isRTL?void 0:s.isRTL(o.floating))?"start":"end")?"left":"right"):(r=h,t="end"===f?"top":"bottom");let y=m-c[t],_=g-c[r],k=!e.middlewareData.shift,x=y,S=_;if(p){let e=g-c.left-c.right;S=f||k?u(_,e):e}else{let e=m-c.top-c.bottom;x=f||k?u(y,e):e}if(k&&!f){let e=d(c.left,0),t=d(c.right,0),r=d(c.top,0),i=d(c.bottom,0);p?S=g-2*(0!==e||0!==t?e+t:d(c.left,c.right)):x=m-2*(0!==r||0!==i?r+i:d(c.top,c.bottom))}await a({...e,availableWidth:S,availableHeight:x});let E=await s.getDimensions(o.floating);return g!==E.width||m!==E.height?{reset:{rects:!0}}:{}}},er&&eh({element:er,padding:M}),eR({arrowWidth:es,arrowHeight:eo}),J&&{name:"hide",options:j={strategy:"referenceHidden",...e_},async fn(e){let{rects:t}=e,{strategy:r="referenceHidden",...i}=v(j,e);switch(r){case"referenceHidden":{let r=$(await C(e,{...i,elementContext:"reference"}),t.reference);return{data:{referenceHiddenOffsets:r,referenceHidden:R(r)}}}case"escaped":{let r=$(await C(e,{...i,altBoundary:!0}),t.floating);return{data:{escapedOffsets:r,escaped:R(r)}}}default:return{}}}}]}),[eC,eL]=eA(eS),eI=(0,ev.W)(W);(0,ew.b)(()=>{eP&&(null==eI||eI())},[eP,eI]);let eD=null===(a=ej.arrow)||void 0===a?void 0:a.x,eN=null===(l=ej.arrow)||void 0===l?void 0:l.y,eU=(null===(c=ej.arrow)||void 0===c?void 0:c.centerOffset)!==0,[eF,eM]=(0,n.useState)();return(0,ew.b)(()=>{X&&eM(window.getComputedStyle(X).zIndex)},[X]),(0,n.createElement)("div",{ref:ek.setFloating,"data-radix-popper-content-wrapper":"",style:{...eT,transform:eP?eT.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:eF,"--radix-popper-transform-origin":[null===(h=ej.transformOrigin)||void 0===h?void 0:h.x,null===(f=ej.transformOrigin)||void 0===f?void 0:f.y].join(" ")},dir:e.dir},(0,n.createElement)(eO,{scope:L,placedSide:eC,onArrowChange:ei,arrowX:eD,arrowY:eN,shouldHideArrow:eU},(0,n.createElement)(em.WV.div,(0,i.Z)({"data-side":eC,"data-align":eL},V,{ref:et,style:{...V.style,animation:eP?void 0:"none",opacity:null!==(g=ej.hide)&&void 0!==g&&g.referenceHidden?0:void 0}}))))}),eC={top:"bottom",right:"left",bottom:"top",left:"right"};function e$(e){return null!==e}let eR=e=>({name:"transformOrigin",options:e,fn(t){var r,i,n,s,o;let{placement:a,rects:l,middlewareData:c}=t,h=(null===(r=c.arrow)||void 0===r?void 0:r.centerOffset)!==0,u=h?0:e.arrowWidth,d=h?0:e.arrowHeight,[f,p]=eA(a),g={start:"0%",center:"50%",end:"100%"}[p],m=(null!==(i=null===(n=c.arrow)||void 0===n?void 0:n.x)&&void 0!==i?i:0)+u/2,y=(null!==(s=null===(o=c.arrow)||void 0===o?void 0:o.y)&&void 0!==s?s:0)+d/2,v="",w="";return"bottom"===f?(v=h?g:`${m}px`,w=`${-d}px`):"top"===f?(v=h?g:`${m}px`,w=`${l.floating.height+d}px`):"right"===f?(v=`${-d}px`,w=h?g:`${y}px`):"left"===f&&(v=`${l.floating.width+d}px`,w=h?g:`${y}px`),{data:{x:v,y:w}}}});function eA(e){let[t,r="center"]=e.split("-");return[t,r]}let eL=e=>{let{__scopePopper:t,children:r}=e,[i,s]=(0,n.useState)(null);return(0,n.createElement)(eT,{scope:t,anchor:i,onAnchorChange:s},r)};r(2651);var eI=r(9115),eD=r(8426),eN=r(7342);let eU=(0,n.forwardRef)((e,t)=>(0,n.createElement)(em.WV.span,(0,i.Z)({},e,{ref:t,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...e.style}}))),[eF,eM]=(0,a.b)("Tooltip",[ek]),ez=ek(),eB="tooltip.open",[eq,eH]=eF("TooltipProvider"),eJ="Tooltip",[eK,eW]=eF(eJ),eG="TooltipTrigger",eV=(0,n.forwardRef)((e,t)=>{let{__scopeTooltip:r,...a}=e,l=eW(eG,r),c=eH(eG,r),h=ez(r),u=(0,n.useRef)(null),d=(0,o.e)(t,u,l.onTriggerChange),f=(0,n.useRef)(!1),p=(0,n.useRef)(!1),g=(0,n.useCallback)(()=>f.current=!1,[]);return(0,n.useEffect)(()=>()=>document.removeEventListener("pointerup",g),[g]),(0,n.createElement)(eS,(0,i.Z)({asChild:!0},h),(0,n.createElement)(em.WV.button,(0,i.Z)({"aria-describedby":l.open?l.contentId:void 0,"data-state":l.stateAttribute},a,{ref:d,onPointerMove:(0,s.M)(e.onPointerMove,e=>{"touch"===e.pointerType||p.current||c.isPointerInTransitRef.current||(l.onTriggerEnter(),p.current=!0)}),onPointerLeave:(0,s.M)(e.onPointerLeave,()=>{l.onTriggerLeave(),p.current=!1}),onPointerDown:(0,s.M)(e.onPointerDown,()=>{f.current=!0,document.addEventListener("pointerup",g,{once:!0})}),onFocus:(0,s.M)(e.onFocus,()=>{f.current||l.onOpen()}),onBlur:(0,s.M)(e.onBlur,l.onClose),onClick:(0,s.M)(e.onClick,l.onClose)})))}),[eY,eZ]=eF("TooltipPortal",{forceMount:void 0}),eX="TooltipContent",eQ=(0,n.forwardRef)((e,t)=>{let r=eZ(eX,e.__scopeTooltip),{forceMount:s=r.forceMount,side:o="top",...a}=e,l=eW(eX,e.__scopeTooltip);return(0,n.createElement)(eI.z,{present:s||l.open},l.disableHoverableContent?(0,n.createElement)(e3,(0,i.Z)({side:o},a,{ref:t})):(0,n.createElement)(e0,(0,i.Z)({side:o},a,{ref:t})))}),e0=(0,n.forwardRef)((e,t)=>{let r=eW(eX,e.__scopeTooltip),s=eH(eX,e.__scopeTooltip),a=(0,n.useRef)(null),l=(0,o.e)(t,a),[c,h]=(0,n.useState)(null),{trigger:u,onClose:d}=r,f=a.current,{onPointerInTransitChange:p}=s,g=(0,n.useCallback)(()=>{h(null),p(!1)},[p]),m=(0,n.useCallback)((e,t)=>{let r=e.currentTarget,i={x:e.clientX,y:e.clientY},n=function(e,t){let r=Math.abs(t.top-e.y),i=Math.abs(t.bottom-e.y),n=Math.abs(t.right-e.x),s=Math.abs(t.left-e.x);switch(Math.min(r,i,n,s)){case s:return"left";case n:return"right";case r:return"top";case i:return"bottom";default:throw Error("unreachable")}}(i,r.getBoundingClientRect());h(function(e){let t=e.slice();return t.sort((e,t)=>e.x<t.x?-1:e.x>t.x?1:e.y<t.y?-1:e.y>t.y?1:0),function(e){if(e.length<=1)return e.slice();let t=[];for(let r=0;r<e.length;r++){let i=e[r];for(;t.length>=2;){let e=t[t.length-1],r=t[t.length-2];if((e.x-r.x)*(i.y-r.y)>=(e.y-r.y)*(i.x-r.x))t.pop();else break}t.push(i)}t.pop();let r=[];for(let t=e.length-1;t>=0;t--){let i=e[t];for(;r.length>=2;){let e=r[r.length-1],t=r[r.length-2];if((e.x-t.x)*(i.y-t.y)>=(e.y-t.y)*(i.x-t.x))r.pop();else break}r.push(i)}return(r.pop(),1===t.length&&1===r.length&&t[0].x===r[0].x&&t[0].y===r[0].y)?t:t.concat(r)}(t)}([...function(e,t,r=5){let i=[];switch(t){case"top":i.push({x:e.x-r,y:e.y+r},{x:e.x+r,y:e.y+r});break;case"bottom":i.push({x:e.x-r,y:e.y-r},{x:e.x+r,y:e.y-r});break;case"left":i.push({x:e.x+r,y:e.y-r},{x:e.x+r,y:e.y+r});break;case"right":i.push({x:e.x-r,y:e.y-r},{x:e.x-r,y:e.y+r})}return i}(i,n),...function(e){let{top:t,right:r,bottom:i,left:n}=e;return[{x:n,y:t},{x:r,y:t},{x:r,y:i},{x:n,y:i}]}(t.getBoundingClientRect())])),p(!0)},[p]);return(0,n.useEffect)(()=>()=>g(),[g]),(0,n.useEffect)(()=>{if(u&&f){let e=e=>m(e,f),t=e=>m(e,u);return u.addEventListener("pointerleave",e),f.addEventListener("pointerleave",t),()=>{u.removeEventListener("pointerleave",e),f.removeEventListener("pointerleave",t)}}},[u,f,m,g]),(0,n.useEffect)(()=>{if(c){let e=e=>{let t=e.target,r={x:e.clientX,y:e.clientY},i=(null==u?void 0:u.contains(t))||(null==f?void 0:f.contains(t)),n=!function(e,t){let{x:r,y:i}=e,n=!1;for(let e=0,s=t.length-1;e<t.length;s=e++){let o=t[e].x,a=t[e].y,l=t[s].x,c=t[s].y;a>i!=c>i&&r<(l-o)*(i-a)/(c-a)+o&&(n=!n)}return n}(r,c);i?g():n&&(g(),d())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[u,f,c,d,g]),(0,n.createElement)(e3,(0,i.Z)({},e,{ref:l}))}),[e1,e2]=eF(eJ,{isInside:!1}),e3=(0,n.forwardRef)((e,t)=>{let{__scopeTooltip:r,children:s,"aria-label":o,onEscapeKeyDown:a,onPointerDownOutside:c,...h}=e,u=eW(eX,r),d=ez(r),{onClose:f}=u;return(0,n.useEffect)(()=>(document.addEventListener(eB,f),()=>document.removeEventListener(eB,f)),[f]),(0,n.useEffect)(()=>{if(u.trigger){let e=e=>{let t=e.target;null!=t&&t.contains(u.trigger)&&f()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[u.trigger,f]),(0,n.createElement)(l.XB,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:a,onPointerDownOutside:c,onFocusOutside:e=>e.preventDefault(),onDismiss:f},(0,n.createElement)(ej,(0,i.Z)({"data-state":u.stateAttribute},d,h,{ref:t,style:{...h.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),(0,n.createElement)(eD.A4,null,s),(0,n.createElement)(e1,{scope:r,isInside:!0},(0,n.createElement)(eU,{id:u.contentId,role:"tooltip"},o||s))))}),e4=e=>{let{__scopeTooltip:t,delayDuration:r=700,skipDelayDuration:i=300,disableHoverableContent:s=!1,children:o}=e,[a,l]=(0,n.useState)(!0),c=(0,n.useRef)(!1),h=(0,n.useRef)(0);return(0,n.useEffect)(()=>{let e=h.current;return()=>window.clearTimeout(e)},[]),(0,n.createElement)(eq,{scope:t,isOpenDelayed:a,delayDuration:r,onOpen:(0,n.useCallback)(()=>{window.clearTimeout(h.current),l(!1)},[]),onClose:(0,n.useCallback)(()=>{window.clearTimeout(h.current),h.current=window.setTimeout(()=>l(!0),i)},[i]),isPointerInTransitRef:c,onPointerInTransitChange:(0,n.useCallback)(e=>{c.current=e},[]),disableHoverableContent:s},o)},e5=e=>{let{__scopeTooltip:t,children:r,open:i,defaultOpen:s=!1,onOpenChange:o,disableHoverableContent:a,delayDuration:l}=e,h=eH(eJ,e.__scopeTooltip),u=ez(t),[d,f]=(0,n.useState)(null),p=(0,c.M)(),g=(0,n.useRef)(0),m=null!=a?a:h.disableHoverableContent,y=null!=l?l:h.delayDuration,v=(0,n.useRef)(!1),[w=!1,b]=(0,eN.T)({prop:i,defaultProp:s,onChange:e=>{e?(h.onOpen(),document.dispatchEvent(new CustomEvent(eB))):h.onClose(),null==o||o(e)}}),_=(0,n.useMemo)(()=>w?v.current?"delayed-open":"instant-open":"closed",[w]),k=(0,n.useCallback)(()=>{window.clearTimeout(g.current),v.current=!1,b(!0)},[b]),T=(0,n.useCallback)(()=>{window.clearTimeout(g.current),b(!1)},[b]),x=(0,n.useCallback)(()=>{window.clearTimeout(g.current),g.current=window.setTimeout(()=>{v.current=!0,b(!0)},y)},[y,b]);return(0,n.useEffect)(()=>()=>window.clearTimeout(g.current),[]),(0,n.createElement)(eL,u,(0,n.createElement)(eK,{scope:t,contentId:p,open:w,stateAttribute:_,trigger:d,onTriggerChange:f,onTriggerEnter:(0,n.useCallback)(()=>{h.isOpenDelayed?x():k()},[h.isOpenDelayed,x,k]),onTriggerLeave:(0,n.useCallback)(()=>{m?T():window.clearTimeout(g.current)},[T,m]),onOpen:k,onClose:T,disableHoverableContent:m},r))},e6=eV,e9=eQ},4873:function(e,t,r){function i(e){let t=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===t?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===t||"string"==typeof e||"[object String]"===t?e:NaN)}function n(e,t){let r=+i(e),[n,s]=[+i(t.start),+i(t.end)].sort((e,t)=>e-t);return r>=n&&r<=s}r.d(t,{_:function(){return n}})},2045:function(e,t,r){function i(e,t){let r,i;let d=t?.additionalDigits??2,f=function(e){let t;let r={},i=e.split(n.dateTimeDelimiter);if(i.length>2)return r;if(/:/.test(i[0])?t=i[0]:(r.date=i[0],t=i[1],n.timeZoneDelimiter.test(r.date)&&(r.date=e.split(n.timeZoneDelimiter)[0],t=e.substr(r.date.length,e.length))),t){let e=n.timezone.exec(t);e?(r.time=t.replace(e[1],""),r.timezone=e[1]):r.time=t}return r}(e);if(f.date){let e=function(e,t){let r=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(r);if(!i)return{year:NaN,restDateString:""};let n=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:null===s?n:100*s,restDateString:e.slice((i[1]||i[2]).length)}}(f.date,d);r=function(e,t){if(null===t)return new Date(NaN);let r=e.match(s);if(!r)return new Date(NaN);let i=!!r[4],n=l(r[1]),o=l(r[2])-1,a=l(r[3]),c=l(r[4]),d=l(r[5])-1;if(i)return c>=1&&c<=53&&d>=0&&d<=6?function(e,t,r){let i=new Date(0);i.setUTCFullYear(e,0,4);let n=i.getUTCDay()||7;return i.setUTCDate(i.getUTCDate()+((t-1)*7+r+1-n)),i}(t,c,d):new Date(NaN);{let e=new Date(0);return o>=0&&o<=11&&a>=1&&a<=(h[o]||(u(t)?29:28))&&n>=1&&n<=(u(t)?366:365)?(e.setUTCFullYear(t,o,Math.max(n,a)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);let p=r.getTime(),g=0;if(f.time&&isNaN(g=function(e){let t=e.match(o);if(!t)return NaN;let r=c(t[1]),i=c(t[2]),n=c(t[3]);return(24===r?0===i&&0===n:n>=0&&n<60&&i>=0&&i<60&&r>=0&&r<25)?36e5*r+6e4*i+1e3*n:NaN}(f.time)))return new Date(NaN);if(f.timezone){if(isNaN(i=function(e){if("Z"===e)return 0;let t=e.match(a);if(!t)return 0;let r="+"===t[1]?-1:1,i=parseInt(t[2]),n=t[3]&&parseInt(t[3])||0;return n>=0&&n<=59?r*(36e5*i+6e4*n):NaN}(f.timezone)))return new Date(NaN)}else{let e=new Date(p+g),t=new Date(0);return t.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),t.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),t}return new Date(p+g+i)}r.d(t,{D:function(){return i}});let n={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},s=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,o=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function l(e){return e?parseInt(e):1}function c(e){return e&&parseFloat(e.replace(",","."))||0}let h=[31,null,31,30,31,30,31,31,30,31,30,31];function u(e){return e%400==0||e%4==0&&e%100!=0}}}]);